<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Elements From List 3D | DB Tools </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Elements From List 3D | DB Tools ">
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css?v=20260125">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/kirsch33/dbtools/blob/dev/csharp/wiki/developer-guide/tools/common/elements-from-list-3d.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        localStorage.setItem('theme', 'dark')
        document.documentElement.setAttribute('data-bs-theme', 'dark')
      </script>

      <script src="../../../public/main.js?v=20260125" defer></script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" src="../../../images/logo.png" alt="DB Tools" width="32" height="32">
            DB Tools
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="elements-from-list-3d">Elements From List 3D</h1>

<p><strong>Elements From List 3D</strong> is a utility tool module that provides two related commands for creating and visualizing 3D elements in Revit: placing family instances from CSV coordinate data, and creating filled regions from selected wall and caisson elements.</p>
<h2 id="overview">Overview</h2>
<p>The tool module contains two ribbon commands:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
<th>Availability</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>3D Elements From List</strong></td>
<td>Creates family instances at coordinates specified in a CSV file</td>
<td>Document open</td>
</tr>
<tr>
<td><strong>Filled Regions From Elements</strong></td>
<td>Creates filled regions from selected walls and caissons</td>
<td>Elements selected</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/manifest.yml:6-24</code></p>
</blockquote>
<h2 id="features">Features</h2>
<h3 id="3d-elements-from-list-command">3D Elements From List Command</h3>
<ul>
<li><strong>CSV Import</strong>: Reads coordinate data from user-selected CSV files</li>
<li><strong>Flexible Column Ordering</strong>: Supports any column order with case-insensitive headers</li>
<li><strong>Optional ID Column</strong>: Maps CSV <code>id</code> field to element parameter</li>
<li><strong>Auto-Family Loading</strong>: Automatically loads the required family if not present in project</li>
<li><strong>Multi-Format Support</strong>: Handles integers, decimals, negative values, and scientific notation</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/ElementsFromList3DCommand.cs:13-72</code></p>
</blockquote>
<h3 id="filled-regions-from-elements-command">Filled Regions From Elements Command</h3>
<ul>
<li><strong>Wall Support</strong>: Creates rectangular filled regions from wall bounding boxes</li>
<li><strong>Caisson Support</strong>: Creates circular filled regions from caisson diameter parameters</li>
<li><strong>Style Matching</strong>: Uses &quot;solid gray&quot; non-masking filled region type</li>
<li><strong>Invisible Lines</strong>: Applies invisible line style to region boundaries</li>
<li><strong>Automatic Comments</strong>: Sets &quot;DB Tools&quot; comment on created regions</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/FilledRegionsFromElementsCommand.cs:12-62</code></p>
</blockquote>
<h2 id="architecture">Architecture</h2>
<h3 id="module-structure">Module Structure</h3>
<pre><code>csharp/src/Tools/Common/3DElementsFromList/
+-- ElementsFromList3DToolModule.cs    # Tool module registration
+-- DBTools.ElementsFromList3D.csproj  # Project file
+-- manifest.yml                        # Tool manifest
+-- Features/
|   +-- ElementsFromList3DCommand.cs   # CSV import command
|   +-- FilledRegionsFromElementsCommand.cs  # Filled region command
|   +-- CsvCoordinateParser.cs         # Pure CSV parsing logic
|   +-- CsvElementPlacer.cs            # Element placement service
|   +-- FilledRegionCreator.cs         # Region creation service
+-- Assets/
|   +-- 3d_elements_icon.png           # Command icon
|   +-- filled_regions_icon.png        # Command icon
+-- Tests/
    +-- CsvCoordinateParserTests.cs    # Parser unit tests
    +-- TEST_SUMMARY.md                # Test documentation
</code></pre>
<blockquote>
<p><strong>Source:</strong> Directory structure of <code>csharp/src/Tools/Common/3DElementsFromList/</code></p>
</blockquote>
<h3 id="data-flow">Data Flow</h3>
<pre><code>                    +------------------------+
                    | ElementsFromList3DCommand |
                    +-----------+------------+
                                |
                    (User selects CSV file)
                                |
                                v
                    +------------------------+
                    |   CsvCoordinateParser  |
                    |   (Pure parsing logic) |
                    +-----------+------------+
                                |
                    (CoordinateRecords)
                                |
                                v
                    +------------------------+
                    |    CsvElementPlacer    |
                    |   (Revit integration)  |
                    +-----------+------------+
                                |
              +-----------------+-----------------+
              |                                   |
              v                                   v
    +------------------+              +-------------------+
    | FamilyLoader     |              | Transaction       |
    | (Load/find family)|             | (Create instances)|
    +------------------+              +-------------------+
</code></pre>
<h3 id="separation-of-concerns">Separation of Concerns</h3>
<p>The tool follows a clean separation pattern:</p>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Class</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Command</strong></td>
<td><code>ElementsFromList3DCommand</code></td>
<td>Entry point, file selection, result display</td>
</tr>
<tr>
<td><strong>Parsing</strong></td>
<td><code>CsvCoordinateParser</code></td>
<td>Pure CSV logic, no Revit/file dependencies</td>
</tr>
<tr>
<td><strong>Placement</strong></td>
<td><code>CsvElementPlacer</code></td>
<td>Revit API integration, transaction management</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:59-63</code></p>
</blockquote>
<h2 id="key-classes">Key Classes</h2>
<h3 id="entry-points">Entry Points</h3>
<table>
<thead>
<tr>
<th>Class</th>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ElementsFromList3DToolModule</code></td>
<td><code>ElementsFromList3DToolModule.cs:5-7</code></td>
<td>Empty tool module; uses manifest-driven registration</td>
</tr>
<tr>
<td><code>ElementsFromList3DCommand</code></td>
<td><code>Features/ElementsFromList3DCommand.cs:17-72</code></td>
<td>CSV import command entry point</td>
</tr>
<tr>
<td><code>FilledRegionsFromElementsCommand</code></td>
<td><code>Features/FilledRegionsFromElementsCommand.cs:16-62</code></td>
<td>Filled region command entry point</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/ElementsFromList3DToolModule.cs:5-7</code></p>
</blockquote>
<h3 id="domain-types">Domain Types</h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CoordinateRecord</code></td>
<td><code>Features/CsvCoordinateParser.cs:12-35</code></td>
<td>Immutable struct holding X, Y, Z, and optional ID</td>
</tr>
<tr>
<td><code>CsvParseResult</code></td>
<td><code>Features/CsvCoordinateParser.cs:40-57</code></td>
<td>Result type with success/failure semantics</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:12-35</code></p>
</blockquote>
<h3 id="services">Services</h3>
<table>
<thead>
<tr>
<th>Class</th>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CsvCoordinateParser</code></td>
<td><code>Features/CsvCoordinateParser.cs:63-153</code></td>
<td>Static parser with <code>Parse()</code>, <code>ParseContent()</code>, <code>ParseFile()</code> methods</td>
</tr>
<tr>
<td><code>CsvElementPlacer</code></td>
<td><code>Features/CsvElementPlacer.cs:17-143</code></td>
<td>Creates family instances from coordinate records</td>
</tr>
<tr>
<td><code>FilledRegionCreator</code></td>
<td><code>Features/FilledRegionCreator.cs:16-248</code></td>
<td>Creates filled regions from walls and caissons</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvElementPlacer.cs:17-31</code></p>
</blockquote>
<h2 id="csv-format">CSV Format</h2>
<p>The CSV parser accepts files with the following format:</p>
<h3 id="required-columns">Required Columns</h3>
<ul>
<li><code>x</code> - X coordinate (feet in Revit internal units)</li>
<li><code>y</code> - Y coordinate (feet in Revit internal units)</li>
<li><code>z</code> - Z coordinate (feet in Revit internal units)</li>
</ul>
<h3 id="optional-columns">Optional Columns</h3>
<ul>
<li><code>id</code> - Identifier string (written to element's &quot;ID&quot; parameter if available)</li>
</ul>
<h3 id="format-rules">Format Rules</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header case</td>
<td>Case-insensitive (<code>X</code>, <code>x</code>, <code>X</code> all valid)</td>
</tr>
<tr>
<td>Column order</td>
<td>Any order allowed</td>
</tr>
<tr>
<td>Extra columns</td>
<td>Ignored</td>
</tr>
<tr>
<td>Whitespace</td>
<td>Trimmed from headers and values</td>
</tr>
<tr>
<td>Empty rows</td>
<td>Skipped</td>
</tr>
<tr>
<td>Invalid rows</td>
<td>Skipped (row with unparseable numbers)</td>
</tr>
<tr>
<td>Number format</td>
<td>Integer, decimal, negative, scientific notation</td>
</tr>
<tr>
<td>Line endings</td>
<td>Windows (<code>\r\n</code>), Unix (<code>\n</code>), Mac (<code>\r</code>)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:70-114</code></p>
</blockquote>
<h3 id="example-csv">Example CSV</h3>
<pre><code class="lang-csv">id,x,y,z
P001,100.5,200.25,10.0
P002,150.0,250.5,10.0
P003,200.75,300.0,10.0
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Tests/CsvCoordinateParserTests.cs:453-471</code></p>
</blockquote>
<h2 id="configuration">Configuration</h2>
<h3 id="manifest">Manifest</h3>
<pre><code class="lang-yaml">id: DBTools.ElementsFromList3D
assembly: DBTools
moduleType: DBTools.ElementsFromList3D.ElementsFromList3DToolModule
order: 0
tool:
  ribbonTools:
    - internalName: DBTools.ElementsFromList3D
      commandType: DBTools.ElementsFromList3D.ElementsFromList3DCommand
      availabilityType: DBTools.App.Tools.Availability.DbtDocumentAvailability
      runProfile: InlineUi
      displayText: &quot;3D Elements\nFrom List&quot;
      iconBaseKey: 3d_elements
      tooltip: &quot;Create 3D elements from a CSV file&quot;
      controlKind: PushButton
      order: 10
    - internalName: DBTools.FilledRegionsFromElements
      commandType: DBTools.ElementsFromList3D.FilledRegionsFromElementsCommand
      availabilityType: DBTools.App.Tools.Availability.DbtSelectionAvailability
      runProfile: InlineUi
      displayText: &quot;Filled Regions\nFrom Elements&quot;
      iconBaseKey: filled_regions
      tooltip: &quot;Create filled regions from selected elements&quot;
      controlKind: PushButton
      order: 11
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/manifest.yml:1-24</code></p>
</blockquote>
<h3 id="availability-conditions">Availability Conditions</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Availability Type</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>3D Elements From List</td>
<td><code>DbtDocumentAvailability</code></td>
<td>Any document open</td>
</tr>
<tr>
<td>Filled Regions From Elements</td>
<td><code>DbtSelectionAvailability</code></td>
<td>Elements selected</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/manifest.yml:9,18</code></p>
</blockquote>
<h3 id="family-dependency">Family Dependency</h3>
<p>The 3D Elements command requires a specific family:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>File name</td>
<td><code>3D-Elements-From-List.rfa</code></td>
</tr>
<tr>
<td>Family name</td>
<td><code>3D-Elements-From-List</code></td>
</tr>
<tr>
<td>Category</td>
<td>Generic Model (<code>OST_GenericModel</code>)</td>
</tr>
<tr>
<td>Expected parameter</td>
<td><code>ID</code> (string, for CSV ID mapping)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvElementPlacer.cs:23-24</code></p>
</blockquote>
<p>The placer first searches for an existing family symbol in the document, then loads from the installed family library path if not found.</p>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvElementPlacer.cs:113-142</code></p>
</blockquote>
<h3 id="filled-region-requirements">Filled Region Requirements</h3>
<p>The Filled Regions command requires specific project resources:</p>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filled Region Type</td>
<td>Name contains &quot;solid&quot; AND &quot;gray&quot;, non-masking</td>
</tr>
<tr>
<td>Graphics Style</td>
<td><code>&lt;Invisible lines&gt;</code> (exact name)</td>
</tr>
<tr>
<td>Caisson Family</td>
<td><code>Concrete-Caisson</code> (family name, case-insensitive)</td>
</tr>
<tr>
<td>Caisson Diameter</td>
<td>Type parameter <code>b</code> (double)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/FilledRegionCreator.cs:111-140</code></p>
</blockquote>
<h2 id="api-reference">API Reference</h2>
<h3 id="csvcoordinateparser">CsvCoordinateParser</h3>
<p>The static parser provides three entry points:</p>
<pre><code class="lang-csharp">public static class CsvCoordinateParser
{
    // Parse from string array (already split lines)
    public static CsvParseResult Parse(IReadOnlyList&lt;string&gt; lines);

    // Parse from content string (handles line splitting)
    public static CsvParseResult ParseContent(string csvContent);

    // Parse from file path (handles file I/O)
    public static CsvParseResult ParseFile(string filePath);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:72,121,135</code></p>
</blockquote>
<h3 id="coordinaterecord">CoordinateRecord</h3>
<p>Immutable value type for parsed coordinates:</p>
<pre><code class="lang-csharp">public readonly struct CoordinateRecord : IEquatable&lt;CoordinateRecord&gt;
{
    public double X { get; }
    public double Y { get; }
    public double Z { get; }
    public string? Id { get; }
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:12-25</code></p>
</blockquote>
<h3 id="csvparseresult">CsvParseResult</h3>
<p>Result type with explicit success/failure:</p>
<pre><code class="lang-csharp">public sealed class CsvParseResult
{
    public IReadOnlyList&lt;CoordinateRecord&gt; Records { get; }
    public string? Error { get; }
    public bool IsSuccess =&gt; Error == null;

    public static CsvParseResult Success(IReadOnlyList&lt;CoordinateRecord&gt; records);
    public static CsvParseResult Failure(string error);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvCoordinateParser.cs:40-57</code></p>
</blockquote>
<h3 id="csvelementplacer">CsvElementPlacer</h3>
<p>Creates elements within a transaction:</p>
<pre><code class="lang-csharp">public sealed class CsvElementPlacer
{
    public CsvElementPlacer(ITransactionRunner tx, Document doc, ILogger logger);

    public (int CreatedCount, int FailedCount, string? ErrorMessage) Run(string csvPath);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvElementPlacer.cs:26-33</code></p>
</blockquote>
<h3 id="filledregioncreator">FilledRegionCreator</h3>
<p>Creates filled regions from selected elements:</p>
<pre><code class="lang-csharp">public sealed class FilledRegionCreator
{
    public FilledRegionCreator(ITransactionRunner tx, Document doc, View activeView, ILogger logger);

    public (int CreatedCount, int SkippedCount) Run(ICollection&lt;ElementId&gt; selectedIds);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/FilledRegionCreator.cs:23-31</code></p>
</blockquote>
<h2 id="testing">Testing</h2>
<p>The tool includes comprehensive unit tests for the CSV parser:</p>
<h3 id="test-categories">Test Categories</h3>
<table>
<thead>
<tr>
<th>Category</th>
<th>Test Count</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic Success Cases</td>
<td>5</td>
<td>Valid CSV parsing scenarios</td>
</tr>
<tr>
<td>Column Order Variations</td>
<td>4</td>
<td>Different header orderings</td>
</tr>
<tr>
<td>Whitespace Handling</td>
<td>4</td>
<td>Trimming and empty row skipping</td>
</tr>
<tr>
<td>Number Formats</td>
<td>6</td>
<td>Integer, negative, scientific notation</td>
</tr>
<tr>
<td>Error Cases</td>
<td>6</td>
<td>Null, empty, missing columns</td>
</tr>
<tr>
<td>Invalid Data Handling</td>
<td>3</td>
<td>Malformed rows</td>
</tr>
<tr>
<td>ParseContent (String)</td>
<td>5</td>
<td>Line ending variations</td>
</tr>
<tr>
<td>CoordinateRecord</td>
<td>5</td>
<td>Equality and hash code</td>
</tr>
<tr>
<td>CsvParseResult</td>
<td>2</td>
<td>Success/failure factories</td>
</tr>
<tr>
<td>Integration Scenarios</td>
<td>2</td>
<td>Real-world CSV examples</td>
</tr>
</tbody>
</table>
<p><strong>Total: 42 tests</strong></p>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Tests/TEST_SUMMARY.md:14-104</code></p>
</blockquote>
<h3 id="running-tests">Running Tests</h3>
<pre><code class="lang-bash"># Build test assemblies
bash csharp/build.sh BuildTests

# Run parser tests (headless, no Revit required)
dotnet test csharp/testing/DBTools.BuildArtifacts.Tests/DBTools.BuildArtifacts.Tests.csproj \
  -c Release --filter &quot;FullyQualifiedName~CsvCoordinateParser&quot;
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Tests/DBTools.ElementsFromList3D.Tests.csproj:19-20</code></p>
</blockquote>
<h2 id="user-workflow">User Workflow</h2>
<h3 id="creating-3d-elements">Creating 3D Elements</h3>
<ol>
<li>Click <strong>3D Elements From List</strong> in the ribbon</li>
<li>Select a CSV file with x, y, z columns</li>
<li>Tool parses CSV and validates format</li>
<li>Family is loaded if not present</li>
<li>Elements are created at each coordinate</li>
<li>Summary dialog shows created/failed counts</li>
</ol>
<h3 id="creating-filled-regions">Creating Filled Regions</h3>
<ol>
<li>Select wall or caisson elements in the view</li>
<li>Click <strong>Filled Regions From Elements</strong> in the ribbon</li>
<li>Tool identifies element types (wall vs. caisson)</li>
<li>For walls: creates rectangular regions from bounding box</li>
<li>For caissons: creates circular regions from diameter</li>
<li>Summary dialog shows created/skipped counts</li>
</ol>
<h2 id="error-handling">Error Handling</h2>
<p>The tool follows DBTools error handling conventions:</p>
<table>
<thead>
<tr>
<th>Error Condition</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSV file not found</td>
<td>Returns error message, no elements created</td>
</tr>
<tr>
<td>Missing x/y/z columns</td>
<td>Returns error message with column requirement</td>
</tr>
<tr>
<td>Invalid number format</td>
<td>Skips row, continues processing</td>
</tr>
<tr>
<td>Family not found</td>
<td>Attempts auto-load; fails with clear message if unavailable</td>
</tr>
<tr>
<td>No levels in document</td>
<td>Throws with descriptive message</td>
</tr>
<tr>
<td>No selection (regions)</td>
<td>Throws with user instruction</td>
</tr>
<tr>
<td>No suitable region type</td>
<td>Logs warning, returns with all skipped</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/CsvElementPlacer.cs:36-45</code></p>
</blockquote>
<p>All commands display results via the alert service with appropriate variant (Info/Error).</p>
<blockquote>
<p><strong>Source:</strong> <code>csharp/src/Tools/Common/3DElementsFromList/Features/ElementsFromList3DCommand.cs:49-66</code></p>
</blockquote>
<h2 id="related-documentation">Related Documentation</h2>
<ul>
<li><a href="../../architecture/overview.html">Architecture Overview</a> - DBTools architecture and tool discovery</li>
<li><a href="gm.html">Global Mapper</a> - Example of a complex tool module</li>
</ul>
<h2 id="source-files-reviewed">Source Files Reviewed</h2>
<table>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>manifest.yml</code></td>
<td>Tool declaration and ribbon configuration</td>
</tr>
<tr>
<td><code>ElementsFromList3DToolModule.cs</code></td>
<td>Module registration</td>
</tr>
<tr>
<td><code>ElementsFromList3DCommand.cs</code></td>
<td>CSV import command</td>
</tr>
<tr>
<td><code>FilledRegionsFromElementsCommand.cs</code></td>
<td>Filled region command</td>
</tr>
<tr>
<td><code>CsvCoordinateParser.cs</code></td>
<td>Pure CSV parsing logic</td>
</tr>
<tr>
<td><code>CsvElementPlacer.cs</code></td>
<td>Element creation service</td>
</tr>
<tr>
<td><code>FilledRegionCreator.cs</code></td>
<td>Region creation service</td>
</tr>
<tr>
<td><code>DBTools.ElementsFromList3D.csproj</code></td>
<td>Project configuration</td>
</tr>
<tr>
<td><code>CsvCoordinateParserTests.cs</code></td>
<td>Unit tests</td>
</tr>
<tr>
<td><code>TEST_SUMMARY.md</code></td>
<td>Test documentation</td>
</tr>
</tbody>
</table>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/kirsch33/dbtools/blob/dev/csharp/wiki/developer-guide/tools/common/elements-from-list-3d.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          DB Tools - Revit Add-in Toolkit
        </div>
      </div>
    </footer>
  </body>
</html>
