<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>View Template Comparer (VTC) | DB Tools </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="View Template Comparer (VTC) | DB Tools ">
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css?v=20260125">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/kirsch33/dbtools/blob/dev/wiki/developer-guide/tools/testing/vtc.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        localStorage.setItem('theme', 'dark')
        document.documentElement.setAttribute('data-bs-theme', 'dark')
      </script>

      <script src="../../../public/main.js?v=20260125" defer></script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" src="../../../images/logo.png" alt="DB Tools" width="32" height="32">
            DB Tools
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="view-template-comparer-vtc">View Template Comparer (VTC)</h1>

<p>The <strong>View Template Comparer</strong> (VTC) is a Testing category tool that enables side-by-side comparison of Revit view templates, allowing users to identify differences, selectively merge settings, and create new templates from combined configurations.</p>
<p>See also: <a href="vtc-spec.html">Enhanced Design (Internal)</a></p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/manifest.yml:1-21</code></p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>VTC provides a comprehensive solution for managing view template settings across Revit projects. The tool extracts complete template configurations including display settings, template parameter includes, category overrides, and filter overrides, presenting them in a hierarchical diff view for easy comparison and selective merging.</p>
<h3 id="key-capabilities">Key Capabilities</h3>
<ul>
<li><strong>Unified single-tree diff view</strong> with A/B value lanes per setting</li>
<li><strong>Selective merging</strong> - choose individual settings from either template</li>
<li><strong>Apply to existing</strong> - update Template A or B with selected settings</li>
<li><strong>Create merged template</strong> - generate a new template combining selections from both sources</li>
<li><strong>JSON export/import</strong> - serialize template settings for cross-document transfer</li>
<li><strong>Template library</strong> - save and load configurations to local cache</li>
<li><strong>Text dump</strong> - export human-readable settings reports</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Features/VtcCommand.cs:24-28</code></p>
</blockquote>
<h2 id="features">Features</h2>
<h3 id="template-selection">Template Selection</h3>
<p>The tool automatically loads all view templates from the active document, sorted alphabetically. Users select two templates for comparison:</p>
<ul>
<li><strong>Template A</strong> (blue indicator) - the left/source template</li>
<li><strong>Template B</strong> (gold indicator) - the right/target template</li>
</ul>
<p>Templates can be swapped using the swap button for quick side-reversal.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Features/VtcCommand.cs:37-43</code></p>
</blockquote>
<h3 id="settings-comparison">Settings Comparison</h3>
<p>VTC compares four categories of template settings:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Display Properties</strong></td>
<td>Detail Level, Display Style, Parts Visibility, Discipline, Show Hidden Lines</td>
</tr>
<tr>
<td><strong>Template Parameters</strong></td>
<td>Which parameters are included/controlled by the template</td>
</tr>
<tr>
<td><strong>Category Overrides</strong></td>
<td>Visibility and graphics overrides per category and subcategory</td>
</tr>
<tr>
<td><strong>Filter Overrides</strong></td>
<td>Applied filters with visibility and graphics settings</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcEnums.cs:15-24</code></p>
</blockquote>
<p>Each setting shows one of four difference states:</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Same</code></td>
<td>Values match in both templates</td>
</tr>
<tr>
<td><code>Different</code></td>
<td>Values differ between templates</td>
</tr>
<tr>
<td><code>LeftMissing</code></td>
<td>Setting exists only in Template B</td>
</tr>
<tr>
<td><code>RightMissing</code></td>
<td>Setting exists only in Template A</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcEnums.cs:41-47</code></p>
</blockquote>
<h3 id="merge-operations">Merge Operations</h3>
<h4 id="apply-to-template-ab">Apply to Template A/B</h4>
<p>Applies selected settings to an existing template. The tool:</p>
<ol>
<li>Collects all user-selected settings from the diff tree</li>
<li>Opens a Revit transaction</li>
<li>Applies each selected value to the target template</li>
<li>Updates non-controlled parameter list as needed</li>
</ol>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcWindowViewModel.cs:285-288</code> <code>982-1050</code></p>
</blockquote>
<h4 id="create-merged-template">Create Merged Template</h4>
<p>Creates a new view template combining settings from both sources:</p>
<ol>
<li>Duplicates the base template (user-selectable: Template A or B)</li>
<li>Renames to user-specified name</li>
<li>Applies all user-selected settings</li>
<li>Commits the new template to the document</li>
</ol>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcWindowViewModel.cs:1089-1136</code></p>
</blockquote>
<h3 id="exportimport">Export/Import</h3>
<h4 id="json-export">JSON Export</h4>
<p>Exports complete template settings to a JSON file containing:</p>
<ul>
<li>Template ID and name</li>
<li>Display settings (detail level, discipline, etc.)</li>
<li>Template parameter includes list</li>
<li>Category graphics data (visibility, line colors, patterns, weights)</li>
<li>Filter graphics data</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcSerializationService.cs:34-44</code></p>
</blockquote>
<h4 id="json-import">JSON Import</h4>
<p>Imports settings from a JSON file and applies them to the selected template. The import supports <strong>cross-document transfer</strong> by resolving elements by name when IDs don't match.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:236-270</code></p>
</blockquote>
<h3 id="template-library">Template Library</h3>
<p>VTC maintains a local cache of saved template configurations in <code>%APPDATA%/DBTools/Cache/VTC/</code>. Features include:</p>
<ul>
<li><strong>Save</strong> - Store current template configuration with custom name</li>
<li><strong>Load</strong> - Apply saved configuration to Template A or B</li>
<li><strong>Delete</strong> - Remove saved configurations</li>
<li><strong>Refresh</strong> - Update the saved templates list</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Services/VtcTemplateStorageService.cs:14-15</code></p>
</blockquote>
<h3 id="text-dump">Text Dump</h3>
<p>Exports a human-readable text report of template settings including:</p>
<ul>
<li>Template name and view type</li>
<li>All included parameters</li>
<li>Display settings with current values</li>
<li>Category visibility and graphics overrides</li>
<li>Filter visibility and graphics overrides</li>
</ul>
<p>Output is written to a user-selected folder as <code>{TemplateName}_template_dump.txt</code>.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcDumpService.cs:52-179</code></p>
</blockquote>
<h2 id="architecture">Architecture</h2>
<h3 id="module-structure">Module Structure</h3>
<pre><code>DBTools.VTC/
+-- Bootstrap/
|   +-- VtcServiceExtensions.cs      # DI registration
+-- Contracts/
|   +-- IVtcComparisonService.cs     # Comparison/merge interface
|   +-- IVtcDumpService.cs           # Text export interface
|   +-- IVtcSerializationService.cs  # JSON serialization interface
|   +-- VtcDataModels.cs             # Data transfer objects
|   +-- VtcEnums.cs                  # Enumerations
+-- Features/
|   +-- VtcCommand.cs                # Main command entry point
+-- Revit/
|   +-- Compat/
|   |   +-- ElementIdCompat.cs       # ElementId compatibility layer
|   +-- Services/
|       +-- VtcComparisonService.cs  # Revit comparison implementation
|       +-- VtcDumpService.cs        # Revit dump implementation
|       +-- VtcSerializationService.cs # Revit serialization implementation
+-- Services/
|   +-- VtcTemplateStorageService.cs # Local cache storage
+-- UI/
|   +-- Behaviors/
|   |   +-- ScrollSyncBehavior.cs    # Synchronized scrolling
|   +-- Converters/
|   |   +-- VtcDiffBackgroundConverter.cs # Diff color converter
|   +-- ViewModels/
|   |   +-- VtcDiffNodeType.cs       # Tree node types
|   |   +-- VtcDiffTreeBuilder.cs    # Tree construction
|   |   +-- VtcDiffTreeNode.cs       # Tree node model
|   |   +-- VtcTemplateOption.cs     # Dropdown item model
|   |   +-- VtcWindowViewModel.cs    # Main window ViewModel
|   +-- Views/
|       +-- VtcWindow.xaml(.cs)      # Main window
+-- DesignTime/
|   +-- VtcWindowDesignTimeViewModel.cs # XAML designer support
+-- VtcToolModule.cs                 # Tool module registration
+-- manifest.yml                     # Tool manifest
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/</code></p>
</blockquote>
<h3 id="service-contracts">Service Contracts</h3>
<h4 id="ivtccomparisonservice">IVtcComparisonService</h4>
<p>Core comparison and merge operations:</p>
<pre><code class="lang-csharp">public interface IVtcComparisonService
{
    VtcTemplateSettingsModel Extract(object templateObject);
    VtcComparisonResult Compare(VtcTemplateSettingsModel left, VtcTemplateSettingsModel right);
    void ApplySelections(object target, VtcComparisonResult comparison, IReadOnlyCollection&lt;VtcSelection&gt; selections);
    void ApplySnapshot(object target, VtcTemplateSettingsModel source);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/IVtcComparisonService.cs:8-54</code></p>
</blockquote>
<h4 id="ivtcserializationservice">IVtcSerializationService</h4>
<p>JSON import/export and template creation:</p>
<pre><code class="lang-csharp">public interface IVtcSerializationService
{
    string Export(object templateObject, string path);
    VtcTemplateSettingsModel Import(string path);
    object CreateTemplateFromModel(object baseTemplate, VtcTemplateSettingsModel model, string newName);
    void ApplyModel(object targetTemplate, VtcTemplateSettingsModel model);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/IVtcSerializationService.cs:6-27</code></p>
</blockquote>
<h4 id="ivtcdumpservice">IVtcDumpService</h4>
<p>Text report generation:</p>
<pre><code class="lang-csharp">public interface IVtcDumpService
{
    (bool Success, string OutputPath) Run(object templateObject, string outputFolder);
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/IVtcDumpService.cs:6-12</code></p>
</blockquote>
<h3 id="data-models">Data Models</h3>
<h4 id="vtctemplatesettingsmodel">VtcTemplateSettingsModel</h4>
<p>Complete template configuration for serialization:</p>
<pre><code class="lang-csharp">public sealed record VtcTemplateSettingsModel
{
    public long TemplateId { get; init; }
    public string Name { get; init; }
    public VtcDisplaySettings Display { get; init; }
    public IReadOnlyList&lt;VtcTemplateIncludeData&gt; Includes { get; init; }
    public IReadOnlyList&lt;VtcCategoryGraphicsData&gt; Categories { get; init; }
    public IReadOnlyList&lt;VtcFilterGraphicsData&gt; Filters { get; init; }
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcDataModels.cs:75-86</code></p>
</blockquote>
<h4 id="vtcsettingchange">VtcSettingChange</h4>
<p>Represents a single difference between templates:</p>
<pre><code class="lang-csharp">public sealed record VtcSettingChange
{
    public string Key { get; init; }
    public string DisplayName { get; init; }
    public VtcSettingType SettingType { get; init; }
    public VtcDisplayPropertyKind? DisplayProperty { get; init; }
    public VtcDifferenceKind DifferenceKind { get; init; }
    public string LeftDisplay { get; init; }
    public string RightDisplay { get; init; }
    public object? LeftValue { get; init; }
    public object? RightValue { get; init; }
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcDataModels.cs:91-107</code></p>
</blockquote>
<h3 id="ui-components">UI Components</h3>
<h4 id="alert-body-template-registration">Alert Body Template Registration</h4>
<p>VTC registers its custom alert body templates at runtime so <code>AlertWindow</code> can resolve VTC-specific body ViewModels outside the main VTC window tree.</p>
<p>Because tool XAML is file-linked into <code>DBTools.dll</code>, the registered resource dictionary must use the file-linked path:</p>
<p><code>pack://application:,,,/{assembly};component/Tools/Testing/VTC/UI/Resources/VtcBodyTemplates.xaml</code></p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Features/VtcCommandHandler.cs:132-158</code>
<strong>Source:</strong> <code>src/DBTools.App/DBTools.App.csproj:69-73</code></p>
</blockquote>
<h4 id="side-by-side-diff-tree">Side-by-Side Diff Tree</h4>
<p>The comparison view uses a <strong>single</strong> hierarchical <code>TreeView</code> with a <strong>flat cell layout</strong> designed to feel like a side-by-side diff viewer:</p>
<p>Each <strong>leaf row</strong> (Setting node) has three zones:</p>
<ul>
<li><strong>Diff glyph</strong> (22px) — <code>≠</code>, <code>+A</code>, <code>+B</code> indicator</li>
<li><strong>Setting name</strong> (260px gutter) — narrow label</li>
<li><strong>Template A value cell</strong> (<code>*</code> width) — clickable flat cell for Template A</li>
<li><strong>Column divider</strong> (1px) — thin vertical rule</li>
<li><strong>Template B value cell</strong> (<code>*</code> width) — clickable flat cell for Template B</li>
</ul>
<p>Row grids bind their width to the active tree viewport (<code>ScrollContentPresenter.ActualWidth</code>) with a <code>TreeView.ActualWidth</code> fallback so A/B star columns expand to the visible lane width instead of collapsing to content width.</p>
<p><strong>Container nodes</strong> (Root, Tab, CategoryGroup) render as <strong>section dividers</strong> that span the full row width with summary badges (e.g., &quot;12 diff · 4 A-only · 2 B-only&quot;) right-aligned.</p>
<p><strong>Click-to-select</strong>: Inspector context is now updated from both explicit row selection and value-cell actions. <code>SelectNodeForInspectorCommand</code> resolves filtered nodes to <code>OriginalNode</code> so Inspector binds to stable backing data. Selection toggling (<code>SelectLeft</code>/<code>SelectRight</code>) via <code>ToggleCellLeftCommand</code>/<code>ToggleCellRightCommand</code> remains gated by <code>IsSelectable</code> (difference rows only). Selected cells show an accent border. No separate checkboxes.</p>
<p><strong>Inspector panel</strong>: The right sidebar includes an Inspector tab that displays the full A vs B breakdown for <code>SelectedNode</code>, with Use A/B buttons and Edit Overrides for category overrides.</p>
<p>Category override rows expose <strong>side-specific visibility and override counts</strong> (<code>LeftVisibilityDisplay</code>, <code>RightVisibilityDisplay</code>, <code>LeftOverrideCount</code>, <code>RightOverrideCount</code>) shown as minimal inline count chips <code>(N)</code> inside the value cells.</p>
<p>The tree structure groups settings by type:</p>
<pre><code>Display Settings
+-- Detail Level
+-- Display Style
+-- ...
Template Parameters
+-- Parameter 1
+-- Parameter 2
+-- ...
Category Overrides
+-- Walls
|   +-- Hidden Lines
|   +-- Surface Pattern
+-- Structural Framing
+-- ...
Filter Overrides
+-- Filter 1
+-- Filter 2
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcDiffTreeBuilder.cs:17-43</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Views/VtcWindow.xaml:221</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Views/VtcWindow.xaml:225</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Resources/VtcDiffStyles.xaml:141</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcWindowViewModel.cs:510</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Views/VtcWindow.xaml.cs:52</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcDiffTreeNode.cs:310</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcDiffTreeNode.cs:373</code></p>
</blockquote>
<p>Node types in the tree:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Root</code></td>
<td>Top-level category (Display Settings, Categories, etc.)</td>
</tr>
<tr>
<td><code>CategoryGroup</code></td>
<td>Parent category containing subcategories</td>
</tr>
<tr>
<td><code>Setting</code></td>
<td>Leaf node with clickable A/B value cells</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcDiffNodeType.cs:6-22</code></p>
</blockquote>
<h4 id="sidebar-workflow">Sidebar Workflow</h4>
<p>The right-side workspace is organized into tabs to reduce control density:</p>
<ul>
<li><strong>Templates</strong> - choose Template A/B and swap</li>
<li><strong>Actions</strong> - apply selections and create merged template</li>
<li><strong>Library</strong> - JSON import/export, text dumps, and saved templates</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Views/VtcWindow.xaml:807</code></p>
</blockquote>
<h4 id="override-pattern-preview-pipeline">Override Pattern Preview Pipeline</h4>
<p>The category-override editor now renders Revit-like fill pattern previews from extracted <code>FillGrid</code> metadata, instead of a color-only swatch.</p>
<p>Flow:</p>
<ol>
<li><code>GetFillPatterns()</code> loads <code>FillPatternElement</code> entries and captures <code>FillPattern.IsSolidFill</code> plus each grid's angle/offset/shift/origin.</li>
<li><code>VtcFillPatternInfo</code> carries the grid metadata into UI ViewModels.</li>
<li><code>VtcFillPatternPreviewFactory</code> converts fill-grid data into a tiled <code>DrawingBrush</code> hatch preview.</li>
<li><code>VtcCategoryOverrideBodyViewModel</code> and <code>VtcFillPatternBodyViewModel</code> invalidate preview brush bindings when pattern/color/visibility changes.</li>
<li><code>VtcBodyTemplates.xaml</code> hosts these brushes in larger preview rectangles for surface/cut sections.</li>
</ol>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcDataModels.cs:215</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:1577</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcFillPatternPreviewFactory.cs:22</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcCategoryOverrideBodyViewModel.cs:50</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcFillPatternBodyViewModel.cs:15</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/Resources/VtcBodyTemplates.xaml:209</code></p>
</blockquote>
<h4 id="linked-file-visibility-support">Linked File Visibility Support</h4>
<p>VTC uses the Revit 2024+ APIs <code>View.GetLinkOverrides()</code> and <code>View.SetLinkOverrides()</code> to fully support per-link visibility overrides:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Support Level</th>
</tr>
</thead>
<tbody>
<tr>
<td>Per-link visibility mode (ByHostView/ByLinkView/Custom)</td>
<td>✅ Full</td>
</tr>
<tr>
<td>Linked view reference</td>
<td>✅ Full</td>
</tr>
<tr>
<td>Copy link overrides between templates</td>
<td>✅ Full</td>
</tr>
</tbody>
</table>
<p>The <code>RevitLinkGraphicsSettings</code> class provides access to:</p>
<ul>
<li><code>LinkVisibilityType</code> - Enum with <code>ByHostView</code>, <code>ByLinkView</code>, or <code>Custom</code> modes</li>
<li><code>LinkedViewId</code> - ElementId of the linked view when using <code>ByLinkView</code> mode</li>
</ul>
<p><strong>Note:</strong> Per-link category graphics overrides within <code>Custom</code> mode are only partially exposed by the Revit API. VTC extracts category information from linked documents using host view overrides as a baseline for comparison.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:962-1033</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:1228-1283</code>
<strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:1326-1378</code></p>
</blockquote>
<h2 id="settings">Settings</h2>
<p>VTC currently has no persistent user settings. All configuration is session-based through the UI.</p>
<h3 id="cache-location">Cache Location</h3>
<p>Saved templates are stored in the user's local application data:</p>
<pre><code>%APPDATA%/DBTools/Cache/VTC/
</code></pre>
<p>Each saved template is stored as a JSON file with sanitized filename.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Services/VtcTemplateStorageService.cs:34</code></p>
</blockquote>
<h2 id="manifest">Manifest</h2>
<pre><code class="lang-yaml">id: DBTools.VTC
assembly: DBTools
moduleType: DBTools.VTC.VtcToolModule
order: 0
sandboxWindows:
  - id: DBTools.VTC.Main
    displayName: &quot;View Template Comparer&quot;
    group: &quot;Testing&quot;
    windowType: &quot;DBTools.VTC.UI.Views.VtcWindow&quot;
    designTimeViewModelType: &quot;DBTools.VTC.DesignTime.VtcWindowDesignTimeViewModel&quot;
tool:
  ribbonTools:
    - internalName: DBTools.ViewTemplateComparer
      commandType: DBTools.VTC.Features.VtcCommand
      availabilityType: DBTools.App.Tools.Availability.DbtDocumentAvailability
      runProfile: InlineUi
      displayText: &quot;View Template\nComparer&quot;
      iconBaseKey: vtc
      tooltip: &quot;Compare and merge view template settings&quot;
      controlKind: PushButton
      order: 50
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/manifest.yml:1-21</code></p>
</blockquote>
<h3 id="manifest-properties">Manifest Properties</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>DBTools.VTC</code></td>
<td>Unique tool identifier</td>
</tr>
<tr>
<td><code>moduleType</code></td>
<td><code>DBTools.VTC.VtcToolModule</code></td>
<td>Tool module class</td>
</tr>
<tr>
<td><code>group</code></td>
<td><code>Testing</code></td>
<td>Ribbon panel group</td>
</tr>
<tr>
<td><code>runProfile</code></td>
<td><code>InlineUi</code></td>
<td>Shows modeless window within Revit</td>
</tr>
<tr>
<td><code>availabilityType</code></td>
<td><code>DbtDocumentAvailability</code></td>
<td>Requires active document</td>
</tr>
<tr>
<td><code>controlKind</code></td>
<td><code>PushButton</code></td>
<td>Standard ribbon button</td>
</tr>
</tbody>
</table>
<h2 id="cross-document-import">Cross-Document Import</h2>
<p>VTC supports importing template settings from JSON files created in different Revit documents. When element IDs don't match (common across documents), the service falls back to name-based resolution:</p>
<h3 id="parameters">Parameters</h3>
<p>Searches <code>ParameterElement</code> and <code>GlobalParameter</code> types by name.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:239-270</code></p>
</blockquote>
<h3 id="categories">Categories</h3>
<p>Handles both top-level and subcategories using &quot;Parent : Subcategory&quot; naming convention.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:296-340</code></p>
</blockquote>
<h3 id="filters">Filters</h3>
<p>Searches <code>ParameterFilterElement</code> instances by name.</p>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Revit/Services/VtcComparisonService.cs:398-415</code></p>
</blockquote>
<h2 id="graphics-override-data">Graphics Override Data</h2>
<p>VTC captures comprehensive graphics override settings for categories and filters:</p>
<pre><code class="lang-csharp">public sealed record VtcOverrideGraphicsData
{
    public VtcColorData? ProjectionLineColor { get; init; }
    public long? ProjectionLinePatternId { get; init; }
    public int? ProjectionLineWeight { get; init; }
    public int? Transparency { get; init; }
    public int? CutLineWeight { get; init; }
    public VtcColorData? CutLineColor { get; init; }
    public long? CutLinePatternId { get; init; }
    public long? CutForegroundPatternId { get; init; }
    public VtcColorData? CutForegroundPatternColor { get; init; }
}
</code></pre>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Contracts/VtcDataModels.cs:17-34</code></p>
</blockquote>
<h2 id="error-handling">Error Handling</h2>
<p>VTC uses the standard DBTools alert service for user notifications. The ViewModel provides centralized error and success messaging:</p>
<ul>
<li><strong>No templates found</strong> - Warning shown if document contains no view templates</li>
<li><strong>Template not found</strong> - Error if selected template cannot be resolved</li>
<li><strong>No selections</strong> - Error if merge attempted without any settings selected</li>
<li><strong>Duplicate name</strong> - Error if new template name already exists</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/UI/ViewModels/VtcWindowViewModel.cs:472-488</code></p>
</blockquote>
<h2 id="testing">Testing</h2>
<p>VTC includes unit tests for core logic that doesn't require Revit:</p>
<ul>
<li><code>VtcTemplateStorageServiceTests.cs</code> - File I/O operations</li>
<li><code>VtcDiffTreeNodeTests.cs</code> - Tree node behavior</li>
<li><code>VtcDiffTreeBuilderTests.cs</code> - Tree construction from change lists</li>
</ul>
<blockquote>
<p><strong>Source:</strong> <code>src/Tools/Testing/VTC/Tests/</code></p>
</blockquote>
<p>Tests are located in <code>src/Tools/Testing/VTC/Tests/</code> and run via the standard test runner without requiring Revit.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/kirsch33/dbtools/blob/dev/wiki/developer-guide/tools/testing/vtc.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          DB Tools - Revit Add-in Toolkit
        </div>
      </div>
    </footer>
  </body>
</html>
